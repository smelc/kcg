<!-- The configuration used to test https://github.com/smelc/kcg -->
<config>
  <substitution>
    <entry name="jsonlint" value="jsonlint-php"/>
    <entry name="gradle" value="./gradlew"/>
  </substitution>
  <builder name="kcg">
    <!-- json -->
    <shell command="which $[jsonlint]"/>
    <shell command="$[jsonlint] cardgen/src/commonMain/resources/data.json"/>
    <!-- build: JVM -->
    <shell command="$[gradle] jvmMainClasses" workdir="cardgen"/>
    <shell command="$[gradle] jvmTestClasses" workdir="cardgen"/>
    <!-- build: Javascript -->
    <shell command="$[gradle] jsMainClasses" workdir="cardgen"/>
    <shell command="$[gradle] jsTest"        workdir="cardgen"/>
    <!-- build: ai -->
    <shell command="stack build"      workdir="ai"/>
    <shell command="stack run ai-exe" workdir="ai"/>
    <!-- check that .hs files are all formatted -->
    <shell command="ormolu -m check $(git ls-files '*.hs' | xargs)"/>
  </builder>
</config>
